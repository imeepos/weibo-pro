@import 'tailwindcss';

@source "../";

@theme {
  --color-workflow-primary: #818cf8;
  --color-workflow-primary-light: #a5b4fc;
  --color-workflow-secondary: #c084fc;
  --color-workflow-accent: #60a5fa;
  --color-workflow-success: #34d399;
  --color-workflow-warning: #fbbf24;
  --color-workflow-error: #f87171;
  --color-workflow-muted: #94a3b8;

  --color-node-bg: #1e293b;
  --color-node-bg-hover: #334155;
  --color-node-border: #334155;
  --color-node-border-hover: #475569;
  --color-node-selected: #1e1b4b;

  --color-edge-data: #64748b;
  --color-edge-control: #a855f7;
  --color-edge-hover: #818cf8;

  --color-panel-bg: #0f172a;
  --color-panel-border: #1e293b;
  --color-panel-header: #1e293b;
  --color-panel-divider: #334155;

  --font-family-sans: Inter, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  --font-family-mono: 'Fira Code', 'SF Mono', Monaco, Consolas, monospace;

  --font-size-node-title: 0.875rem;
  --font-size-node-label: 0.75rem;
  --font-size-panel-title: 0.875rem;
  --font-size-panel-label: 0.75rem;

  --spacing-node-padding: 1rem;
  --spacing-node-gap: 0.25rem;
  --spacing-panel-padding: 1rem;
  --spacing-panel-gap: 0.75rem;

  --shadow-node: 0 4px 12px rgba(0, 0, 0, 0.4);
  --shadow-node-hover: 0 8px 24px rgba(129, 140, 248, 0.25);
  --shadow-node-selected: 0 0 0 2px #818cf8, 0 8px 24px rgba(129, 140, 248, 0.35);
  --shadow-panel: 0 0 30px rgba(0, 0, 0, 0.5);

  --radius-node: 0.75rem;
  --radius-panel: 0.5rem;

  --transition-fast: 150ms;
  --transition-normal: 200ms;
  --transition-slow: 300ms;
}

:root {
  --workflow-primary: #818cf8;
  --workflow-primary-light: #a5b4fc;
  --workflow-secondary: #c084fc;
  --workflow-accent: #60a5fa;
  --workflow-success: #34d399;
  --workflow-warning: #fbbf24;
  --workflow-error: #f87171;
  --workflow-muted: #94a3b8;

  --node-bg: #1e293b;
  --node-bg-hover: #334155;
  --node-border: #334155;
  --node-border-hover: #475569;
  --node-selected: #1e1b4b;

  --edge-data: #64748b;
  --edge-control: #a855f7;
  --edge-hover: #818cf8;

  --panel-bg: #0f172a;
  --panel-border: #1e293b;
  --panel-header: #1e293b;
  --panel-divider: #334155;

  --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
  --transition-normal: 200ms cubic-bezier(0.4, 0, 0.2, 1);
  --transition-slow: 300ms cubic-bezier(0.4, 0, 0.2, 1);

  --shadow-node: 0 4px 12px rgba(0, 0, 0, 0.4);
  --shadow-node-hover: 0 8px 24px rgba(129, 140, 248, 0.25);
  --shadow-node-selected: 0 0 0 2px var(--workflow-primary), 0 8px 24px rgba(129, 140, 248, 0.35);
  --shadow-panel: 0 0 30px rgba(0, 0, 0, 0.5);
}

* {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

body {
  font-family: Inter, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  background-color: #000000;
  color: #e2e8f0;
}

.react-flow__node {
  /* 移除 transition 以确保拖动流畅 */
  /* transition: all var(--transition-normal); */
  /* 防止宽度异常但允许内容自适应 */
  min-width: 120px;
  max-width: 320px;
  box-sizing: border-box;
  /* 确保选中时不会出现异常宽度 */
  width: fit-content !important;
}

/* 完全移除节点过渡效果，确保拖动流畅 */
.react-flow__node {
  transition: none !important;
}

/* 只对非拖动状态下的特定属性应用过渡 */
.react-flow__node:not(.dragging) {
  transition: box-shadow 0.15s ease, background-color 0.15s ease !important;
}

.react-flow__edge.selected path {
  stroke: var(--workflow-primary);
}

.react-flow__edge:hover path {
  stroke: var(--edge-hover);
}

/* Z-index 层级：连线(1) → 节点(2) → 端口(3) → 交互状态(4+) */
.react-flow__edge {
  z-index: 1;
}

.react-flow__node {
  z-index: 2;
}

.react-flow__edge.selected,
.react-flow__edge:hover {
  z-index: 4;
}

.react-flow__node.dragging {
  z-index: 5;
}

.react-flow__connection-line {
  z-index: 6;
}

.property-panel {
  @apply flex flex-col h-full border-l;
  background-color: var(--panel-bg);
  border-color: var(--panel-border);
}

.property-panel-empty {
  @apply flex flex-col items-center justify-center h-full text-center;
  padding: var(--spacing-panel-padding);
}

.property-panel-empty p {
  @apply text-sm font-semibold;
  color: #cbd5e1;
}

.property-panel-hint {
  @apply text-xs mt-2;
  color: var(--workflow-muted);
}

.property-panel-header {
  @apply flex items-center justify-between border-b;
  background-color: var(--panel-header);
  border-color: var(--panel-divider);
  padding: var(--spacing-panel-padding);
}

.property-panel-title {
  @apply text-sm font-semibold;
  color: #f1f5f9;
}

.property-panel-type {
  @apply text-xs font-mono;
  color: var(--workflow-muted);
}

.property-panel-content {
  @apply flex-1 overflow-y-auto;
  padding: var(--spacing-panel-padding);
}

.property-panel-content > * + * {
  margin-top: var(--spacing-panel-gap);
}

.property-panel-section {
  @apply space-y-3;
}

.property-panel-section-title {
  @apply text-xs uppercase tracking-wide mb-2;
  color: #94a3b8;
  font-weight: 600;
}

.property-field {
  @apply space-y-1.5;
}

.property-field-readonly {
  @apply opacity-70;
}

.property-field-label {
  @apply block text-xs font-medium;
  color: #cbd5e1;
}

.property-field-value {
  @apply w-full px-3 py-2 text-sm font-mono rounded-md border;
  background-color: #0f172a;
  border-color: #334155;
  color: #94a3b8;
}

.property-field-error {
  background-color: #450a0a;
  border-color: #7f1d1d;
  color: var(--workflow-error);
}
